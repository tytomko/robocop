<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>ROS 웹 인터페이스</title>
    <style>
        #camera-canvas {
            max-width: 100%;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <h1>ROS 웹 인터페이스</h1>
    <canvas id="camera-canvas"></canvas>

    <script>
        const ws = new WebSocket('ws://localhost:3000/ws');
        const canvas = document.getElementById('camera-canvas');
        const ctx = canvas.getContext('2d');

        ws.onmessage = function(event) {
            const data = JSON.parse(event.data);
            if (data.image) {
                // Canvas 크기 설정
                canvas.width = data.width;
                canvas.height = data.height;

                // Base64 디코딩
                const binary = atob(data.image);
                const array = new Uint8ClampedArray(binary.length);
                for (let i = 0; i < binary.length; i++) {
                    array[i] = binary.charCodeAt(i);
                }

                // ImageData 생성 및 캔버스에 그리기
                const imageData = new ImageData(array, data.width, data.height);
                ctx.putImageData(imageData, 0, 0);
                
                console.log('이미지 데이터 수신:', data.width, 'x', data.height);
            }
        };

        ws.onerror = function(error) {
            console.error('WebSocket 에러:', error);
        };

        ws.onclose = function() {
            console.log('WebSocket 연결이 종료되었습니다');
        };
    </script>
</body>
</html> 